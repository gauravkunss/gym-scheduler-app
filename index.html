<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gym Scheduler App</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        const Dumbbell = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M14.4 14.4 9.6 9.6"/><path d="M18.657 21.485a2 2 0 1 1-2.829-2.828l-1.767 1.768a2 2 0 1 1-2.829-2.829l6.364-6.364a2 2 0 1 1 2.829 2.829l-1.768 1.767a2 2 0 1 1 2.828 2.829z"/><path d="m21.5 21.5-1.4-1.4"/><path d="M3.9 3.9 2.5 2.5"/><path d="M6.404 12.768a2 2 0 1 1-2.829-2.829l1.768-1.767a2 2 0 1 1-2.828-2.829l2.828-2.828a2 2 0 1 1 2.829 2.828l1.767-1.768a2 2 0 1 1 2.829 2.829z"/></svg>;
        const Plus = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M5 12h14"/><path d="M12 5v14"/></svg>;
        const Trash2 = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 6h18"/><path d="m19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>;
        const Calendar = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>;
        const CalendarPlus = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/><path d="M10 16h4"/><path d="M12 14v4"/></svg>;
        const CheckCircle = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>;
        const XCircle = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>;

        const bodyPartExercises = {
          'Chest': ['Barbell Flat Bench Press', 'Barbell Incline Bench Press', 'Barbell Decline Bench Press', 'Dumbbell Flat Bench Press', 'Dumbbell Incline Bench Press', 'Dumbbell Decline Bench Press', 'Machine Chest Press', 'Machine Incline Chest Press', 'Machine Decline Chest Press', 'Cable Chest Press', 'Cable Incline Chest Press', 'Cable Decline Chest Press', 'Dumbbell Flat Flyes', 'Dumbbell Incline Flyes', 'Dumbbell Decline Flyes', 'Cable Crossover High to Low', 'Cable Crossover Low to High', 'Cable Crossover Middle', 'Pec Deck Machine', 'Chest Dips', 'Push-Ups', 'Incline Push-Ups', 'Decline Push-Ups', 'Diamond Push-Ups', 'Wide Grip Push-Ups', 'Barbell Floor Press', 'Dumbbell Floor Press', 'Resistance Band Chest Press', 'Smith Machine Flat Bench Press', 'Smith Machine Incline Bench Press', 'Smith Machine Decline Bench Press', 'Dumbbell Pullover', 'Barbell Pullover', 'Cable Pullover', 'Single-Arm Dumbbell Press', 'Single-Arm Cable Press', 'Squeeze Press', 'Hex Press'],
          'Back': ['Barbell Row', 'Dumbbell Row', 'Cable Row', 'Machine Row', 'T-Bar Row', 'Pendlay Row', 'Yates Row', 'Seated Cable Row Wide Grip', 'Seated Cable Row Close Grip', 'Seated Cable Row Neutral Grip', 'Pull-Ups Wide Grip', 'Pull-Ups Close Grip', 'Pull-Ups Neutral Grip', 'Chin-Ups', 'Lat Pulldown Wide Grip', 'Lat Pulldown Close Grip', 'Lat Pulldown Neutral Grip', 'Lat Pulldown Reverse Grip', 'Single-Arm Dumbbell Row', 'Single-Arm Cable Row', 'Barbell Deadlift', 'Dumbbell Deadlift', 'Trap Bar Deadlift', 'Romanian Deadlift Barbell', 'Romanian Deadlift Dumbbell', 'Rack Pull', 'Cable Face Pull', 'Dumbbell Face Pull', 'Straight-Arm Pulldown', 'Resistance Band Rows', 'Kettlebell Row', 'Inverted Row', 'Renegade Row', 'Good Morning Barbell', 'Good Morning Dumbbell', 'Superman Hold', 'Reverse Fly Dumbbell', 'Reverse Fly Cable', 'Reverse Fly Machine', 'Barbell Shrug', 'Dumbbell Shrug', 'Cable Shrug', 'Machine Shrug'],
          'Shoulders': ['Barbell Overhead Press', 'Dumbbell Overhead Press', 'Machine Shoulder Press', 'Cable Shoulder Press', 'Smith Machine Shoulder Press', 'Barbell Behind Neck Press', 'Dumbbell Arnold Press', 'Single-Arm Dumbbell Press', 'Single-Arm Cable Press', 'Seated Barbell Press', 'Seated Dumbbell Press', 'Standing Barbell Military Press', 'Dumbbell Lateral Raise', 'Cable Lateral Raise', 'Machine Lateral Raise', 'Dumbbell Front Raise', 'Barbell Front Raise', 'Cable Front Raise', 'Plate Front Raise', 'Dumbbell Rear Delt Fly', 'Cable Rear Delt Fly', 'Machine Rear Delt Fly', 'Reverse Pec Deck', 'Barbell Upright Row', 'Dumbbell Upright Row', 'Cable Upright Row', 'Cable Face Pull', 'Band Pull Apart', 'Pike Push-Up', 'Handstand Push-Up', 'Dumbbell Around the World'],
          'Biceps': ['Barbell Curl', 'EZ Bar Curl', 'Dumbbell Curl', 'Cable Curl', 'Machine Curl', 'Hammer Curl Dumbbell', 'Hammer Curl Cable', 'Concentration Curl', 'Preacher Curl Barbell', 'Preacher Curl EZ Bar', 'Preacher Curl Dumbbell', 'Preacher Curl Machine', 'Preacher Curl Cable', 'Incline Dumbbell Curl', 'Seated Dumbbell Curl', 'Standing Dumbbell Curl', 'Standing Barbell Curl', 'Cable Curl Rope', 'Cable Curl Bar', 'Single-Arm Cable Curl', 'Spider Curl Barbell', 'Spider Curl Dumbbell', 'Spider Curl EZ Bar', 'Zottman Curl', 'Reverse Curl Barbell', 'Reverse Curl EZ Bar', 'Reverse Curl Dumbbell', 'Drag Curl', 'Cross-Body Hammer Curl', '21s', 'Resistance Band Curl', 'Chin-Up', 'Seated Alternating Curl'],
          'Triceps': ['Barbell Close-Grip Bench Press', 'Dumbbell Close-Grip Bench Press', 'Smith Machine Close-Grip Bench Press', 'Tricep Dips', 'Bench Dips', 'Parallel Bar Dips', 'Barbell Skull Crushers', 'Dumbbell Skull Crushers', 'EZ Bar Skull Crushers', 'Cable Skull Crushers', 'Overhead Dumbbell Extension', 'Overhead Barbell Extension', 'Overhead Cable Extension', 'Cable Rope Pushdown', 'Cable Bar Pushdown', 'Cable Reverse Grip Pushdown', 'Cable Single-Arm Pushdown', 'Machine Tricep Extension', 'Dumbbell Kickbacks', 'Cable Kickbacks', 'Diamond Push-Ups', 'Close-Grip Push-Ups', 'Dumbbell Floor Press', 'Lying Dumbbell Extension', 'Lying Barbell Extension', 'Resistance Band Pushdown', 'Bodyweight Tricep Extension', 'Dumbbell Tate Press', 'Single-Arm Overhead Extension'],
          'Legs': ['Barbell Back Squat', 'Barbell Front Squat', 'Dumbbell Squat', 'Goblet Squat', 'Smith Machine Squat', 'Hack Squat Machine', 'Leg Press', 'V-Squats', 'Sissy Squat', 'Barbell Lunges', 'Dumbbell Lunges', 'Walking Lunge Barbell', 'Walking Lunge Dumbbell', 'Reverse Lunge Barbell', 'Reverse Lunge Dumbbell', 'Side Lunge', 'Bulgarian Split Squat Barbell', 'Bulgarian Split Squat Dumbbell', 'Step-Ups Barbell', 'Step-Ups Dumbbell', 'Leg Extension Machine', 'Leg Curl Machine Lying', 'Leg Curl Machine Seated', 'Barbell Romanian Deadlift', 'Dumbbell Romanian Deadlift', 'Barbell Sumo Deadlift', 'Dumbbell Sumo Deadlift', 'Single-Leg Deadlift Barbell', 'Single-Leg Deadlift Dumbbell', 'Glute Bridge Barbell', 'Glute Bridge Dumbbell', 'Glute Bridge Bodyweight', 'Hip Thrust Barbell', 'Hip Thrust Dumbbell', 'Hip Thrust Machine', 'Wall Sit', 'Box Jump', 'Standing Calf Raise Machine', 'Standing Calf Raise Barbell', 'Standing Calf Raise Dumbbell', 'Seated Calf Raise Machine', 'Donkey Calf Raise', 'Single-Leg Calf Raise', 'Calf Press on Leg Press', 'Smith Machine Calf Raise', 'Jump Rope Calves', 'Farmer\'s Walk on Toes', 'Tib Raises', 'Calf Raise Hold', 'Explosive Calf Jumps'],
          'Forearms': ['Barbell Wrist Curl', 'Dumbbell Wrist Curl', 'Cable Wrist Curl', 'Barbell Reverse Wrist Curl', 'Dumbbell Reverse Wrist Curl', 'Cable Reverse Wrist Curl', 'Behind-the-Back Wrist Curl', 'Farmer\'s Carry Dumbbell', 'Farmer\'s Carry Barbell', 'Farmer\'s Carry Kettlebell', 'Plate Pinch Hold', 'Towel Pull-Up', 'Dead Hang', 'Barbell Hold', 'Dumbbell Hold', 'Hex Dumbbell Hold', 'Hammer Curl', 'Reverse Curl Barbell', 'Reverse Curl Dumbbell', 'Reverse Curl Cable', 'Zottman Curl', 'Finger Curl', 'Rope Climb', 'Wrist Roller', 'Grip Trainer Squeeze', 'Towel Squeeze', 'Rice Bucket Drill'],
          'Core': ['Plank', 'Side Plank', 'Weighted Plank', 'Plank to Push-Up', 'Crunches', 'Bicycle Crunch', 'Cable Crunch', 'Machine Crunch', 'Weighted Crunch', 'Russian Twist Bodyweight', 'Russian Twist Dumbbell', 'Russian Twist Medicine Ball', 'Cable Russian Twist', 'Leg Raise', 'Hanging Leg Raise', 'Captain\'s Chair Leg Raise', 'Ab Wheel Rollout', 'Barbell Rollout', 'Mountain Climber', 'Dead Bug', 'Bird Dog', 'Pallof Press Cable', 'Cable Woodchoppers High to Low', 'Cable Woodchoppers Low to High', 'Toe Touch', 'V-Up', 'Hollow Body Hold', 'Dragon Flag', 'L-Sit', 'Farmer\'s Walk', 'Overhead Farmer\'s Walk'],
          'Abs': ['Crunches', 'Reverse Crunch', 'Weighted Sit-Up', 'Decline Sit-Up', 'Sit-Ups', 'Cable Crunch', 'Machine Crunch', 'Leg Raise', 'Hanging Leg Raise', 'Plank', 'Side Plank', 'Bicycle Crunch', 'Russian Twist', 'Mountain Climber', 'Flutter Kick', 'Scissor Kicks', 'V-Up', 'Ab Wheel Rollout', 'Toe Touch', 'Jackknife', 'Side Bend Cable', 'Side Bend Dumbbell', 'Stability Ball Crunch', 'Dead Bug', 'Oblique Crunch'],
          'Glutes': ['Barbell Hip Thrust', 'Dumbbell Hip Thrust', 'Smith Machine Hip Thrust', 'Machine Hip Thrust', 'Barbell Glute Bridge', 'Dumbbell Glute Bridge', 'Single-Leg Glute Bridge', 'Cable Kickbacks', 'Machine Kickbacks', 'Bulgarian Split Squat', 'Barbell Sumo Deadlift', 'Dumbbell Sumo Deadlift', 'Step-ups Barbell', 'Step-ups Dumbbell', 'Romanian Deadlift', 'Cable Pull Through', 'Frog Pumps', 'Donkey Kicks'],
          'Cardio': ['Treadmill Walking', 'Treadmill Running', 'Treadmill Jogging', 'Treadmill Incline Walk', 'Treadmill Sprints', 'Cycling Stationary Bike', 'Cycling Spin Bike', 'Cycling Recumbent Bike', 'Elliptical', 'Rowing Machine', 'Stair Climber', 'StairMaster', 'Jump Rope', 'Burpees', 'Mountain Climbers', 'High Knees', 'Butt Kicks', 'Jumping Jacks', 'Box Jumps', 'Battle Ropes', 'Assault Bike', 'Ski Erg', 'Swimming', 'Running Outdoor', 'Cycling Outdoor', 'Walking Outdoor', 'Hiking', 'HIIT Circuit', 'Tabata', 'Boxing', 'Kickboxing', 'Shadow Boxing'],
          'Full Body': ['Burpees', 'Barbell Thrusters', 'Dumbbell Thrusters', 'Barbell Clean and Press', 'Dumbbell Clean and Press', 'Kettlebell Clean and Press', 'Turkish Get-ups', 'Battle Ropes', 'Sled Push', 'Sled Pull', 'Farmers Walk', 'Man Makers', 'Devil Press']
        };

        const quotes = ["The only bad workout is the one that didn't happen!", "Discipline is doing what needs to be done!", "You don't have to be great to start!"];

        function GymScheduler() {
          const [workouts, setWorkouts] = useState([]);
          const [showForm, setShowForm] = useState(false);
          const [date, setDate] = useState('');
          const [bodyPart, setBodyPart] = useState('');
          const [exercises, setExercises] = useState(['']);
          const [minDate, setMinDate] = useState('');
          const [showActuals, setShowActuals] = useState(null);
          const [showCalendarHelp, setShowCalendarHelp] = useState(false);

          useEffect(() => {
            const today = new Date();
            setMinDate(`${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`);
          }, []);

          const formatDate = (d) => {
            const date = new Date(d);
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            return `${days[date.getDay()]}, ${months[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;
          };

          const handleSave = () => {
            const valid = exercises.filter(e => e.trim());
            if (!date || !bodyPart || !valid.length) {
              alert('Please fill all fields');
              return;
            }
            setWorkouts([...workouts, { id: Date.now(), date, bodyPart, exercises: valid, actual: null }].sort((a, b) => new Date(a.date) - new Date(b.date)));
            setDate('');
            setBodyPart('');
            setExercises(['']);
            setShowForm(false);
          };

          const downloadICS = (workout) => {
            const startDate = new Date(workout.date + 'T18:00:00');
            const endDate = new Date(workout.date + 'T19:00:00');
            
            const formatICSDate = (date) => {
              return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
            };

            let description = `PLAN:\\nExercises: ${workout.exercises.join(', ')}\\n\\n`;
            if (workout.actual && workout.actual.went === true && workout.actual.data) {
              description += `ACTUAL:\\n`;
              const details = workout.actual.data.map(bp => {
                const exercises = bp.exercises.map(ex => `${ex.exercise} - ${ex.weight}kg`).join(', ');
                return `${bp.bodyPart}: ${exercises}`;
              }).join('\\n');
              description += details;
            }

            const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Gym Scheduler//EN
BEGIN:VEVENT
UID:${workout.id}@gym-scheduler
DTSTAMP:${formatICSDate(new Date())}
DTSTART:${formatICSDate(startDate)}
DTEND:${formatICSDate(endDate)}
SUMMARY:${workout.bodyPart} Workout
DESCRIPTION:${description}
STATUS:CONFIRMED
END:VEVENT
END:VCALENDAR`;

            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${workout.bodyPart}-Workout-${workout.date}.ics`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert('Calendar file downloaded! Open it to add to Google Calendar, Apple Calendar, or Outlook.');
          };
return (
            <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-4">
              <div className="max-w-4xl mx-auto">
                <div className="bg-slate-800 rounded-2xl p-6 mb-6 border border-slate-700">
                  <div className="flex flex-col items-center gap-4">
                    <div className="flex items-center gap-3">
                      <Dumbbell />
                      <h1 className="text-2xl md:text-3xl font-bold text-white">Gym Scheduler</h1>
                    </div>
                    <div style={{height: '40px'}}></div>
                    <div className="flex items-center gap-2">
                      {workouts.length > 0 && (
                        <button onClick={() => setShowCalendarHelp(true)} className="flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg text-xs md:text-sm">
                          <CalendarPlus />
                          <span>Save to Calendar</span>
                        </button>
                      )}
                      <button onClick={() => setShowForm(!showForm)} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-xs md:text-sm">
                        <Plus />
                        <span>Add Workout</span>
                      </button>
                    </div>
                  </div>
                </div>

                {showForm && (
                  <div className="bg-slate-800 rounded-2xl p-6 mb-6 border border-slate-700">
                    <div className="flex justify-between items-center mb-4">
                      <h2 className="text-xl font-bold text-white">Schedule New Workout</h2>
                      <button onClick={() => { setShowForm(false); setDate(''); setBodyPart(''); setExercises(['']); }} className="text-slate-400 hover:text-white">
                        <XCircle />
                      </button>
                    </div>
                    <div className="space-y-4">
                      <div>
                        <label className="block text-slate-300 mb-2 text-sm font-medium">Date</label>
                        <input type="date" value={date} onChange={(e) => setDate(e.target.value)} min={minDate} className="w-full bg-slate-700 text-white border border-slate-600 rounded-lg px-4 py-2" />
                      </div>
                      <div>
                        <label className="block text-slate-300 mb-2 text-sm font-medium">Body Part</label>
                        <select value={bodyPart} onChange={(e) => { setBodyPart(e.target.value); setExercises(['']); }} className="w-full bg-slate-700 text-white border border-slate-600 rounded-lg px-4 py-2">
                          <option value="">Select...</option>
                          {Object.keys(bodyPartExercises).map(bp => <option key={bp} value={bp}>{bp}</option>)}
                        </select>
                      </div>
                      <div>
                        <label className="block text-slate-300 mb-2 text-sm font-medium">Exercises</label>
                        {exercises.map((ex, i) => (
                          <div key={i} className="flex gap-2 mb-2">
                            <select value={ex} onChange={(e) => { const n = [...exercises]; n[i] = e.target.value; setExercises(n); }} disabled={!bodyPart} className="flex-1 bg-slate-700 text-white border border-slate-600 rounded-lg px-4 py-2 disabled:opacity-50">
                              <option value="">Select...</option>
                              {bodyPart && bodyPartExercises[bodyPart]?.map(e => <option key={e} value={e}>{e}</option>)}
                            </select>
                            {exercises.length > 1 && <button onClick={() => setExercises(exercises.filter((_, idx) => idx !== i))} className="bg-red-600 text-white px-3 rounded-lg"><Trash2 /></button>}
                          </div>
                        ))}
                        <button onClick={() => setExercises([...exercises, ''])} disabled={!bodyPart} className="text-blue-400 text-sm disabled:opacity-50">+ Add exercise</button>
                      </div>
                      <div className="flex gap-3">
                        <button onClick={handleSave} className="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg">Save as Plan</button>
                        <button onClick={() => { setShowForm(false); setDate(''); setBodyPart(''); setExercises(['']); }} className="flex-1 bg-slate-700 text-white px-6 py-2 rounded-lg">Cancel</button>
                      </div>
                    </div>
                  </div>
                )}

                <div className="space-y-4">
                  {workouts.map(w => (
                    <div key={w.id} className="bg-slate-800 rounded-2xl p-6 border border-slate-700">
                      <div className="flex justify-between mb-4">
                        <div className="flex items-center gap-2">
                          <Calendar />
                          <span className="text-white">{formatDate(w.date)}</span>
                          {w.actual?.went && <CheckCircle />}
                          {w.actual?.went === false && <XCircle />}
                        </div>
                        <button onClick={() => setWorkouts(workouts.filter(x => x.id !== w.id))} className="text-red-400"><Trash2 /></button>
                      </div>

                      <div className="mb-4">
                        <h3 className="text-lg font-bold text-blue-400 mb-2">Plan</h3>
                        <div className="bg-slate-700/50 rounded-lg p-3 mb-2">
                          <p className="text-white font-bold">{w.bodyPart}</p>
                        </div>
                        <ul className="space-y-1">
                          {w.exercises.map((ex, i) => <li key={i} className="text-slate-300 text-sm">â€¢ {ex}</li>)}
                        </ul>
                      </div>

                      <div className="border-t border-slate-700 pt-4">
                        <h3 className="text-lg font-bold text-green-400 mb-2">Actuals</h3>
                        {!w.actual ? (
                          <div className="space-y-2">
                            <button onClick={() => setShowActuals(w)} className="w-full bg-green-600 text-white px-4 py-2 rounded-lg">Record Actual</button>
                            <button onClick={() => downloadICS(w)} className="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2">
                              <CalendarPlus />
                              Download Calendar File
                            </button>
                          </div>
                        ) : w.actual.went === false ? (
                          <div className="space-y-2">
                            <div className="bg-red-900/20 border border-red-700 rounded-lg p-3">
                              <p className="text-red-300 italic text-sm">"{quotes[Math.floor(Math.random() * quotes.length)]}"</p>
                            </div>
                            <button onClick={() => downloadICS(w)} className="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2">
                              <CalendarPlus />
                              Download Calendar File
                            </button>
                          </div>
                        ) : (
                          <div className="space-y-2">
                            {w.actual.data?.map((bp, i) => (
                              <div key={i} className="bg-slate-700/50 rounded-lg p-3">
                                <p className="text-white font-bold text-sm mb-1">{bp.bodyPart}</p>
                                {bp.exercises.map((ex, j) => <p key={j} className="text-slate-300 text-xs">{ex.exercise} - <span className="text-green-400 font-semibold">{ex.weight} kg</span></p>)}
                              </div>
                            ))}
                            <button onClick={() => downloadICS(w)} className="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg flex items-center justify-center gap-2 mt-2">
                              <CalendarPlus />
                              Download Calendar File
                            </button>
                          </div>
                        )}
                      </div>
                    </div>
                  ))}
                </div>

                {showActuals && <ActualsModal workout={showActuals} onClose={() => setShowActuals(null)} onSave={(went, data) => { setWorkouts(workouts.map(w => w.id === showActuals.id ? { ...w, actual: { went, data } } : w)); setShowActuals(null); }} />}
                
                {showCalendarHelp && (
                  <div className="fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50">
                    <div className="bg-slate-800 rounded-2xl p-6 max-w-md w-full border border-slate-700">
                      <div className="flex justify-between items-center mb-4">
                        <h2 className="text-2xl font-bold text-white">Save to Calendar</h2>
                        <button onClick={() => setShowCalendarHelp(false)} className="text-slate-400 hover:text-white">
                          <XCircle />
                        </button>
                      </div>
                      <div className="space-y-4 text-slate-300">
                        <p>To add workouts to your calendar:</p>
                        <ol className="list-decimal list-inside space-y-2 text-sm">
                          <li>Click "Download Calendar File" on any workout</li>
                          <li>A .ics file will be downloaded</li>
                          <li>Open the file to add to your calendar app</li>
                          <li>Works with Google Calendar, Apple Calendar, Outlook, etc.</li>
                        </ol>
                        <div className="bg-purple-900/20 border border-purple-600 rounded-lg p-3">
                          <p className="text-purple-200 text-sm">ðŸ’¡ <strong>Tip:</strong> The file includes both your planned and actual workout data!</p>
                        </div>
                      </div>
                      <div className="flex gap-3 mt-4">
                        <button onClick={() => setShowCalendarHelp(false)} className="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg">Got it!</button>
                        <button onClick={() => setShowCalendarHelp(false)} className="flex-1 bg-slate-700 hover:bg-slate-600 text-white px-6 py-2 rounded-lg">Cancel</button>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        }

        function ActualsModal({ workout, onClose, onSave }) {
          const [went, setWent] = useState('');
          const [bps, setBps] = useState([{ bodyPart: '', exercises: [{ exercise: '', weight: '' }] }]);

          const copyFromPlan = () => {
            setBps([{
              bodyPart: workout.bodyPart,
              exercises: workout.exercises.map(ex => ({ exercise: ex, weight: '' }))
            }]);
            alert('Plan copied! Now fill in the weights.');
          };

          const formatDate = (d) => {
            const date = new Date(d);
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            return {
              day: days[date.getDay()],
              date: `${months[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`
            };
          };

          const { day, date } = formatDate(workout.date);

return (
            <div className="fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50 overflow-y-auto">
              <div className="bg-slate-800 rounded-2xl p-6 max-w-2xl w-full my-8 border border-slate-700">
                <div className="flex justify-between items-center mb-4">
                  <h2 className="text-2xl font-bold text-white">Record Actual Workout</h2>
                  <button onClick={onClose} className="text-slate-400 hover:text-white">
                    <XCircle />
                  </button>
                </div>
                
                <div className="mb-4 p-4 bg-slate-700/50 rounded-lg">
                  <p className="text-slate-400 text-sm">Date</p>
                  <p className="text-white font-semibold">{day}, {date}</p>
                </div>

                <div className="mb-4">
                  <label className="block text-slate-300 mb-2 text-sm font-medium">Went to gym?</label>
                  <select value={went} onChange={(e) => setWent(e.target.value)} className="w-full bg-slate-700 text-white border border-slate-600 rounded-lg px-4 py-2">
                    <option value="">Select...</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                  </select>
                </div>

                {went === 'yes' && (
                  <div className="bg-purple-900/30 border-2 border-purple-500 rounded-xl p-4 mb-4">
                    <button onClick={copyFromPlan} className="w-full bg-purple-600 text-white px-6 py-4 rounded-lg font-bold text-lg">
                      ðŸ“‹ Same as Plan
                    </button>
                    <p className="text-purple-200 text-sm mt-3 text-center">Click to copy exercises from plan!</p>
                  </div>
                )}

                {went === 'yes' && (
                  <div className="space-y-4">
                    {bps.map((bp, bpI) => (
                      <div key={bpI} className="border border-slate-600 rounded-lg p-4">
                        <select value={bp.bodyPart} onChange={(e) => { const n = [...bps]; n[bpI].bodyPart = e.target.value; n[bpI].exercises = [{ exercise: '', weight: '' }]; setBps(n); }} className="w-full bg-slate-700 text-white border border-slate-600 rounded-lg px-4 py-2 mb-3">
                          <option value="">Body Part...</option>
                          {Object.keys(bodyPartExercises).map(b => <option key={b} value={b}>{b}</option>)}
                        </select>
                        {bp.exercises.map((ex, exI) => (
                          <div key={exI} className="flex gap-2 mb-2">
                            <select value={ex.exercise} onChange={(e) => { const n = [...bps]; n[bpI].exercises[exI].exercise = e.target.value; setBps(n); }} disabled={!bp.bodyPart} className="flex-1 bg-slate-700 text-white border border-slate-600 rounded-lg px-4 py-2 disabled:opacity-50">
                              <option value="">Exercise...</option>
                              {bp.bodyPart && bodyPartExercises[bp.bodyPart]?.map(e => <option key={e} value={e}>{e}</option>)}
                            </select>
                            <input type="number" placeholder="kg" value={ex.weight} onChange={(e) => { const n = [...bps]; n[bpI].exercises[exI].weight = e.target.value; setBps(n); }} className="w-24 bg-slate-700 text-white border border-slate-600 rounded-lg px-4 py-2" />
                          </div>
                        ))}
                        <button onClick={() => { const n = [...bps]; n[bpI].exercises.push({ exercise: '', weight: '' }); setBps(n); }} disabled={!bp.bodyPart} className="text-blue-400 text-sm disabled:opacity-50">+ Add Exercise</button>
                      </div>
                    ))}
                    <button onClick={() => setBps([...bps, { bodyPart: '', exercises: [{ exercise: '', weight: '' }] }])} className="text-green-400 text-sm">+ Add Body Part</button>
                  </div>
                )}

                {went === 'no' && (
                  <div className="bg-red-900/20 border border-red-700 rounded-lg p-4 mb-4">
                    <p className="text-red-300 italic text-sm">"{quotes[Math.floor(Math.random() * quotes.length)]}"</p>
                  </div>
                )}

                <div className="flex gap-3 mt-6">
                  <button onClick={() => {
                    if (!went) { alert('Please select if you went to gym'); return; }
                    if (went === 'no') { onSave(false, null); return; }
                    const validData = bps.filter(b => b.bodyPart && b.exercises.some(e => e.exercise && e.weight)).map(b => ({ bodyPart: b.bodyPart, exercises: b.exercises.filter(e => e.exercise && e.weight) }));
                    if (validData.length === 0) { alert('Please add at least one exercise with weight'); return; }
                    onSave(true, validData);
                  }} className="flex-1 bg-green-600 text-white px-6 py-2 rounded-lg">Save Actual</button>
                  <button onClick={onClose} className="flex-1 bg-slate-700 text-white px-6 py-2 rounded-lg">Cancel</button>
                </div>
              </div>
            </div>
          );
        }

        ReactDOM.render(<GymScheduler />, document.getElementById('root'));
    </script>
</body>
</html>